<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<div class="container mt-4">
  <!-- Header -->
  <div class="card shadow-sm mb-4">
    <div class="card-body bg-gradient text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
      <h2 class="display-6 mb-2">
        <i class="bi bi-arrow-left-right me-2"></i>Data Import / Export
      </h2>
      <p class="mb-0 opacity-75">Import and export your data in various formats</p>
    </div>
  </div>

  <div class="row">
    <!-- Import Section -->
    <div class="col-lg-6">
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-light">
          <h5 class="mb-0">
            <i class="bi bi-cloud-upload me-2 text-primary"></i>Import Data
          </h5>
        </div>
        <div class="card-body">
          <p class="text-muted mb-3">Upload your data file (CSV or Excel format)</p>
          
          <div class="mb-4">
            <label for="fileUpload" class="form-label fw-bold">
              <i class="bi bi-file-earmark-arrow-up me-2"></i>Select File
            </label>
            <input 
              type="file" 
              class="form-control" 
              id="fileUpload"
              (change)="onFileSelected($event)" 
              accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
            <small class="text-muted d-block mt-2">
              <i class="bi bi-info-circle me-1"></i>
              Supported formats: CSV, XLS, XLSX
            </small>
          </div>

          <div class="alert alert-info d-flex align-items-start" role="alert">
            <i class="bi bi-lightbulb me-3 fs-4"></i>
            <div>
              <strong>Import Tips</strong>
              <ul class="mb-0 mt-2 small">
                <li>Ensure your file has headers in the first row</li>
                <li>Maximum file size: 10MB</li>
                <li>Check data format matches expected schema</li>
              </ul>
            </div>
          </div>

          <div class="d-flex gap-2" *ngIf="importedData.length > 0">
            <button class="btn btn-success flex-grow-1">
              <i class="bi bi-check-circle me-2"></i>Process Import
            </button>
            <button class="btn btn-outline-danger" (click)="clearImport()">
              <i class="bi bi-x-circle"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Export Section -->
    <div class="col-lg-6">
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-light">
          <h5 class="mb-0">
            <i class="bi bi-cloud-download me-2 text-primary"></i>Export Data
          </h5>
        </div>
        <div class="card-body">
          <p class="text-muted mb-3">Download your data in your preferred format</p>
          
          <div class="mb-3">
            <label class="form-label fw-bold">
              <i class="bi bi-gear me-2"></i>Export Options
            </label>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="includeHeaders" checked>
              <label class="form-check-label" for="includeHeaders">
                Include column headers
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="includeMetadata">
              <label class="form-check-label" for="includeMetadata">
                Include metadata
              </label>
            </div>
          </div>

          <div class="mb-3">
            <label for="dateRange" class="form-label fw-bold">
              <i class="bi bi-calendar-range me-2"></i>Date Range
            </label>
            <select class="form-select" id="dateRange">
              <option selected>All Time</option>
              <option>Last 7 Days</option>
              <option>Last 30 Days</option>
              <option>Last 90 Days</option>
              <option>Custom Range</option>
            </select>
          </div>

          <div class="d-grid gap-2">
            <button (click)="exportCSV()" class="btn btn-primary">
              <i class="bi bi-file-earmark-spreadsheet me-2"></i>Export as CSV
            </button>
            <button (click)="exportExcel()" class="btn btn-success">
              <i class="bi bi-file-earmark-excel me-2"></i>Export as Excel
            </button>
            <button class="btn btn-outline-secondary">
              <i class="bi bi-filetype-json me-2"></i>Export as JSON
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Preview Section -->
  <div class="card shadow-sm" *ngIf="importedData.length > 0">
    <div class="card-header bg-light d-flex justify-content-between align-items-center">
      <h5 class="mb-0">
        <i class="bi bi-eye me-2 text-primary"></i>Data Preview
      </h5>
      <span class="badge bg-primary">{{ importedData.length }} rows</span>
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover table-striped mb-0">
          <thead class="table-light sticky-top">
            <tr>
              <th class="text-center" style="width: 50px;">#</th>
              <th *ngFor="let header of previewHeaders">
                <i class="bi bi-tag me-1"></i>{{ header }}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of importedData; let i = index" [hidden]="i >= 10">
              <td class="text-center text-muted">{{ i + 1 }}</td>
              <td *ngFor="let header of previewHeaders">{{ row[header] }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="card-footer bg-light text-muted">
      <i class="bi bi-info-circle me-2"></i>
      Showing first 10 rows of {{ importedData.length }} total rows
    </div>
  </div>

  <!-- Empty State -->
  <div class="card shadow-sm text-center py-5" *ngIf="importedData.length === 0">
    <div class="card-body">
      <i class="bi bi-inbox display-1 text-muted"></i>
      <h5 class="text-muted mt-3">No Data Imported Yet</h5>
      <p class="text-muted">Upload a file to see a preview of your data</p>
    </div>
  </div>

  <!-- Stats Summary -->
  <div class="row g-4 mt-4">
    <div class="col-md-3">
      <div class="card shadow-sm text-center">
        <div class="card-body">
          <i class="bi bi-file-earmark-arrow-up display-4 text-primary"></i>
          <h4 class="mt-2">125</h4>
          <p class="text-muted mb-0">Total Imports</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card shadow-sm text-center">
        <div class="card-body">
          <i class="bi bi-file-earmark-arrow-down display-4 text-success"></i>
          <h4 class="mt-2">89</h4>
          <p class="text-muted mb-0">Total Exports</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card shadow-sm text-center">
        <div class="card-body">
          <i class="bi bi-database display-4 text-info"></i>
          <h4 class="mt-2">15.2 MB</h4>
          <p class="text-muted mb-0">Data Processed</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card shadow-sm text-center">
        <div class="card-body">
          <i class="bi bi-clock-history display-4 text-warning"></i>
          <h4 class="mt-2">Today</h4>
          <p class="text-muted mb-0">Last Activity</p>
        </div>
      </div>
    </div>
  </div>
</div>