<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <button class="btn btn-outline-secondary btn-sm mb-3" routerLink="/dashboard">
        <i class="bi bi-arrow-left me-2"></i>Back to Dashboard
      </button>
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h2 class="mb-0">Create Notification</h2>
        </div>
        <div class="card-body">
          <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
            {{ errorMessage }}
          </div>

          <form (ngSubmit)="createNotification()" #notificationForm="ngForm">
            <div class="mb-3">
              <label for="recipientId" class="form-label">Recipient ID <span class="text-danger">*</span></label>
              <input 
                type="number" 
                class="form-control" 
                id="recipientId"
                [(ngModel)]="notification.recipientId" 
                name="recipientId"
                required
                min="1">
            </div>

            <div class="mb-3">
              <label for="recipientEmail" class="form-label">Recipient Email</label>
              <input 
                type="email" 
                class="form-control" 
                id="recipientEmail"
                [(ngModel)]="notification.recipientEmail" 
                name="recipientEmail"
                placeholder="example@email.com">
            </div>

            <div class="mb-3">
              <label for="recipientPhone" class="form-label">Recipient Phone</label>
              <input 
                type="tel" 
                class="form-control" 
                id="recipientPhone"
                [(ngModel)]="notification.recipientPhone" 
                name="recipientPhone"
                placeholder="+1234567890">
            </div>

            <div class="mb-3">
              <label for="recipientName" class="form-label">Recipient Name</label>
              <input 
                type="text" 
                class="form-control" 
                id="recipientName"
                [(ngModel)]="notification.recipientName" 
                name="recipientName"
                placeholder="John Doe">
            </div>

            <div class="mb-3">
              <label for="notificationType" class="form-label">Notification Type <span class="text-danger">*</span></label>
              <select 
                class="form-select" 
                id="notificationType"
                [(ngModel)]="notification.notificationType" 
                name="notificationType"
                required>
                <option *ngFor="let type of notificationTypes" [value]="type">
                  {{ formatEnumValue(type) }}
                </option>
              </select>
            </div>

            <div class="mb-3">
              <label for="channel" class="form-label">Channel <span class="text-danger">*</span></label>
              <select 
                class="form-select" 
                id="channel"
                [(ngModel)]="notification.channel" 
                name="channel"
                required>
                <option *ngFor="let ch of channels" [value]="ch">
                  {{ ch }}
                </option>
              </select>
            </div>

            <div class="mb-3">
              <label for="subject" class="form-label">Subject</label>
              <input 
                type="text" 
                class="form-control" 
                id="subject"
                [(ngModel)]="notification.subject" 
                name="subject"
                placeholder="Enter subject (for email)">
            </div>

            <div class="mb-3">
              <label for="message" class="form-label">Message <span class="text-danger">*</span></label>
              <textarea 
                class="form-control" 
                id="message"
                [(ngModel)]="notification.message" 
                name="message"
                rows="4"
                required
                placeholder="Enter notification message"></textarea>
            </div>

            <div class="mb-3">
              <label for="scheduledTime" class="form-label">Scheduled Time (Optional)</label>
              <input 
                type="datetime-local" 
                class="form-control" 
                id="scheduledTime"
                [(ngModel)]="notification.scheduledTime" 
                name="scheduledTime">
              <small class="form-text text-muted">Leave empty to send immediately</small>
            </div>

            <div class="d-flex justify-content-end gap-2">
              <button 
                type="button" 
                class="btn btn-secondary" 
                (click)="cancel()"
                [disabled]="loading">
                Cancel
              </button>
              <button 
                type="submit" 
                class="btn btn-primary" 
                [disabled]="!notificationForm.form.valid || loading">
                <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                {{ loading ? 'Creating...' : 'Create Notification' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
